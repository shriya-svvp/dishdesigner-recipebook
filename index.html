<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dish Designer</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #fff;
      scroll-behavior: smooth;
    }

    /* Navbar */
    .navbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 50px;
      background: #fff8f0;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 10;
    }
    .logo {
      font-size: 22px;
      font-weight: bold;
      color: #f5a623;
    }
    .nav-links {
      display: flex;
      gap: 30px;
      font-size: 16px;
    }
    .nav-links a, .nav-links button {
      text-decoration: none;
      color: black;
      font-weight: 500;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 16px;
    }

    /* Right side container */
    .right-controls {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    /* Search bar */
    .search-bar {
      display: flex;
      align-items: center;
      border: 2px solid #f5a623;
      border-radius: 20px;
      padding: 4px 10px;
      background: #fff;
    }
    .search-bar input {
      border: none;
      outline: none;
      padding: 6px 10px;
      font-size: 14px;
      flex: 1;
    }
    .search-bar button {
      border: none;
      background: none;
      cursor: pointer;
      font-size: 16px;
      color: #f5a623;
    }

    /* Login/Logout Buttons */
    .login-btn, .logout-btn {
      padding: 8px 16px;
      background: #f5a623;
      color: white !important;
      border-radius: 6px;
      font-weight: bold;
      border: none;
      cursor: pointer;
      transition: background 0.3s;
    }
    .login-btn:hover, .logout-btn:hover {
      background: #e63946;
    }

    /* Modal Background */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0; top: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.6);
      justify-content: center;
      align-items: center;
    }

    /* Modal Content */
    .modal-content {
      background: #fff;
      padding: 25px;
      border-radius: 10px;
      width: 350px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
      animation: fadeIn 0.3s ease-in-out;
    }

    .modal-content h2 {
      margin-top: 0;
      color: #f5a623;
      text-align: center;
    }

    .modal-content form {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .modal-content input, .modal-content select {
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 14px;
    }

    .modal-content button {
      padding: 10px;
      background: #f5a623;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
    }
    .modal-content button:hover {
      background: #e63946;
    }

    .close {
      float: right;
      font-size: 22px;
      cursor: pointer;
      color: #333;
    }
    .close:hover {
      color: red;
    }

    .switch-link {
      text-align: center;
      margin-top: 10px;
      font-size: 14px;
    }
    .switch-link a {
      color: #f5a623;
      text-decoration: none;
      font-weight: bold;
      cursor: pointer;
    }
    .switch-link a:hover {
      color: #e63946;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.8); }
      to { opacity: 1; transform: scale(1); }
    }

    /* Hero Section */
    .hero {
      position: relative;
      height: 100vh;
      background: url("images/family.png") no-repeat center center/cover;
      display: flex;
      align-items: center;
      padding: 0 60px;
      color: black;
    }
    .hero-text {
      background: rgba(255, 255, 255, 0.8);
      padding: 20px 30px;
      border-radius: 8px;
      max-width: 500px;
    }
    .hero-text h1 {
      font-size: 42px;
      font-weight: bold;
    }
    .hero-text p {
      font-size: 20px;
      margin-top: 15px;
      color: #333;
    }
    .hero-text .btn {
      margin-top: 20px;
      padding: 12px 24px;
      background: #f5a623;
      color: white;
      border: none;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      border-radius: 5px;
    }

    /* About Us */
    .about-section {
      padding: 60px 40px;
      background: #fff8f0;
      text-align: center;
    }
    .about-section h2 {
      font-size: 32px;
      margin-bottom: 20px;
      color: #f5a623;
    }
    .about-section p {
      max-width: 800px;
      margin: auto;
      font-size: 18px;
      color: #333;
      line-height: 1.6;
    }

    /* Contact */
    .contact-section {
      padding: 60px 40px;
      text-align: center;
      background: #fafafa;
    }
    .contact-section h2 {
      font-size: 32px;
      margin-bottom: 30px;
      color: #f5a623;
    }
    .contact-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      justify-items: center;
    }
    .contact-item {
      display: flex;
      align-items: center;
      background: white;
      padding: 15px 20px;
      border-radius: 8px;
      box-shadow: 0px 2px 6px rgba(0,0,0,0.2);
      width: 100%;
      max-width: 350px;
      font-size: 18px;
      justify-content: center;
    }
    .contact-item i {
      font-size: 22px;
      color: #f5a623;
      margin-right: 12px;
    }

    /* Footer */
    footer {
      text-align: center;
      padding: 15px;
      background: #fff8f0;
      border-top: 1px solid #ddd;
      font-size: 14px;
    }
  </style>
</head>
<body>

  <!-- Navbar -->
  <div class="navbar">
    <div class="logo">Dish Designer</div>
    <div class="nav-links">
      <a href="#">Home</a>
      <a href="#about">AboutUs</a>
      <a href="#contact">Contact</a>
      <button onclick="goToCategories()">Categories</button>
    </div>
    <div class="right-controls">
      <div class="search-bar">
        <input type="text" id="searchInput" placeholder="Search recipes...">
        <button id="searchBtn"><i class="fas fa-search"></i></button>
      </div>
      <button id="loginBtn" class="login-btn" onclick="openLogin()">Login</button>
      <button id="logoutBtn" class="login-btn" style="display:none;" onclick="logout()">Logout</button>
    </div>
  </div>

  <!-- Login Modal -->
  <div id="loginModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeLogin()">&times;</span>
      <h2>Login</h2>
      <form id="loginForm">
        <input type="email" id="loginEmail" placeholder="Email Address" required>
        <input type="password" id="loginPassword" placeholder="Password" required>
        <button type="submit">Login</button>
      </form>
      <div class="switch-link">
        Don’t have an account? <a onclick="switchToRegister()">Register</a>
      </div>
    </div>
  </div>

  <!-- Register Modal -->
  <div id="registerModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeRegister()">&times;</span>
      <h2>Register</h2>
      <form id="registerForm">
        <input type="text" id="registerName" placeholder="Full Name" required>
        <input type="email" id="registerEmail" placeholder="Email Address" required>
        <input type="password" id="registerPassword" placeholder="Password" required>
        <input type="password" id="registerConfirm" placeholder="Confirm Password" required>
        <select id="registerRole" required>
          <option value="" disabled selected>Select Role</option>
          <option value="user">User</option>
          <option value="admin">Admin</option>
        </select>
        <button type="submit">Sign Up</button>
      </form>
      <div class="switch-link">
        Already have an account? <a onclick="switchToLogin()">Login</a>
      </div>
    </div>
  </div>

  <!-- Hero Section -->
  <div class="hero">
    <div class="hero-text">
      <h1>Discover Recipes, <br> Design Your Dish</h1>
      <p>Explore Global Flavour <br> And Cook With Confidence</p>
      <button class="btn" onclick="openRegister()">GET STARTED ></button>
    </div>
  </div>

  <!-- About Us -->
  <section id="about" class="about-section">
    <h2>About Us</h2>
    <p>
      Dish Designer is your ultimate recipe companion! Our mission is to make cooking simple, fun, and inspiring. 
      Explore thousands of global dishes, customize recipes to your taste, and create unforgettable meals for your loved ones. 
      Whether you're a beginner or a seasoned chef, Dish Designer helps you design the perfect dish with confidence.
    </p>
  </section>

  <!-- Contact Section -->
  <section id="contact" class="contact-section">
    <h2>Contact Us</h2>
    <div class="contact-grid">
      <div class="contact-item">
        <i class="fas fa-phone"></i>
        <span>+91 9667734567</span>
      </div>
      <div class="contact-item">
        <i class="fas fa-envelope"></i>
        <span>dishdesigner@gmail.com</span>
      </div>
      <div class="contact-item">
        <i class="fas fa-map-marker-alt"></i>
        <span>Bangalore, India</span>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <p>© 2025 Dish Designer. All Rights Reserved.</p>
  </footer>

  <script>
    const API_URL = "https://dishdesigner-recipebook-tgoq.vercel.app";

    // Modal controls
    function openLogin() { document.getElementById("loginModal").style.display = "flex"; }
    function closeLogin() { document.getElementById("loginModal").style.display = "none"; }
    function openRegister() { document.getElementById("registerModal").style.display = "flex"; }
    function closeRegister() { document.getElementById("registerModal").style.display = "none"; }
    function switchToRegister() { closeLogin(); openRegister(); }
    function switchToLogin() { closeRegister(); openLogin(); }

    // Close on outside click
    window.onclick = function(event) {
      let loginModal = document.getElementById("loginModal");
      let registerModal = document.getElementById("registerModal");
      if (event.target == loginModal) { loginModal.style.display = "none"; }
      if (event.target == registerModal) { registerModal.style.display = "none"; }
    }

    // ✅ Handle Login
    document.getElementById("loginForm").addEventListener("submit", async function(e) {
      e.preventDefault();

      let email = document.getElementById("loginEmail").value.trim().toLowerCase();
      let password = document.getElementById("loginPassword").value;

      try {
        let res = await fetch(`${API_URL}/users?email=${encodeURIComponent(email)}&password=${encodeURIComponent(password)}`);
        let users = await res.json();

        if (users.length > 0) {
          let user = users[0];
          alert("Welcome " + user.username);

          localStorage.setItem("loggedInUser", JSON.stringify(user));
          updateAuthButtons();

          if (user.role === "admin") {
            window.location.href = "admin.html";  
          } else {
            window.location.href = "categories.html";  
          }
        } else {
          alert("Invalid email or password");
        }
      } catch (error) {
        console.error("Error logging in:", error);
      }
    });

    // ✅ Handle Register
    document.getElementById("registerForm").addEventListener("submit", async function(e) {
      e.preventDefault();

      let name = document.getElementById("registerName").value;
      let email = document.getElementById("registerEmail").value.trim().toLowerCase();
      let password = document.getElementById("registerPassword").value;
      let confirm = document.getElementById("registerConfirm").value;
      let role = document.getElementById("registerRole").value;

      if (password !== confirm) {
        alert("Passwords do not match!");
        return;
      }

      let newUser = {
        username: name,
        email: email,
        password: password,
        role: role
      };

      try {
        await fetch(`${API_URL}/users`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(newUser)
        });

        alert("Registration successful! Please login.");
        closeRegister();
        openLogin();
      } catch (error) {
        console.error("Error registering user:", error);
      }
    });

    // ✅ Login state check
    function isUserLoggedIn() {
      return !!localStorage.getItem("loggedInUser");
    }

    // ✅ Update Login/Logout buttons
    function updateAuthButtons() {
      let loggedIn = isUserLoggedIn();
      document.getElementById("loginBtn").style.display = loggedIn ? "none" : "inline-block";
      document.getElementById("logoutBtn").style.display = loggedIn ? "inline-block" : "none";
    }

    // ✅ Logout
    function logout() {
      localStorage.removeItem("loggedInUser");
      updateAuthButtons();
      alert("You have logged out.");
      window.location.href = "index.html";
    }

    // ✅ Search
    const searchInput = document.getElementById("searchInput");
    const searchBtn = document.getElementById("searchBtn");

    function handleSearch() {
      const query = searchInput.value.trim();
      if (!query) {
        alert("Please enter a recipe!");
        return;
      }

      if (!isUserLoggedIn()) {
        alert("Please register to search recipes!");
        openRegister(); 
      } else {
        window.location.href = `recipes.html?search=${query}`;
      }
    }

    searchBtn.addEventListener("click", handleSearch);
    searchInput.addEventListener("keypress", function(e) {
      if (e.key === "Enter") handleSearch();
    });

    // ✅ Categories navigation
    function goToCategories() {
      if (!isUserLoggedIn()) {
        alert("Please login/register to explore categories!");
        openRegister();
        return;
      }
      window.location.href = "categories.html";
    }

    // On load update button state
    updateAuthButtons();
  </script>
</body>
</html>
